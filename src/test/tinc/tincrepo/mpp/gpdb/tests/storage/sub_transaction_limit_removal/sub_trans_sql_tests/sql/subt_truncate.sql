Drop table if exists subt_trunc_tab_co;
Create table subt_trunc_tab_co (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true,orientation=column) distributed randomly partition by range (i) (default partition others, start (0) inclusive end (10) exclusive every (5));
Insert into subt_trunc_tab_co values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Drop table if exists subt_trunc_tab_ao;
Create table subt_trunc_tab_ao (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) with(appendonly=true) distributed randomly partition by range (i) (default partition others, start (0) inclusive end (10) exclusive every (5));
Insert into subt_trunc_tab_ao values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Drop table if exists subt_trunc_tab_heap;
Create table subt_trunc_tab_heap (i int, x text,c char,v varchar, d date, n numeric, t timestamp without time zone, tz time with time zone) distributed randomly partition by range (i) (default partition others, start (0) inclusive end (10) exclusive every (5));
Insert into subt_trunc_tab_heap values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
BEGIN;
Savepoint sp1;
Insert into subt_trunc_tab_co values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_co;
Insert into subt_trunc_tab_ao values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_ao;
Insert into subt_trunc_tab_heap values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_heap;
select count(*) from subt_trunc_tab_co;
select count(*) from subt_trunc_tab_ao;
select count(*) from subt_trunc_tab_heap;
Savepoint sp2;
Rollback to sp1;
select count(*) from subt_trunc_tab_co;
select count(*) from subt_trunc_tab_ao;
select count(*) from subt_trunc_tab_heap;
Savepoint sp3;
Insert into subt_trunc_tab_co values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_co;
Insert into subt_trunc_tab_ao values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_ao;
Insert into subt_trunc_tab_heap values(generate_series(1,10),'create table with subtransactions','s','subtransaction table','12-11-2012',3,'2012-10-09 10:23:54', '2011-08-19 10:23:54+02');
Truncate table subt_trunc_tab_heap;
select count(*) from subt_trunc_tab_co;
select count(*) from subt_trunc_tab_ao;
select count(*) from subt_trunc_tab_heap;
Release Savepoint sp1;
select count(*) from subt_trunc_tab_co;
select count(*) from subt_trunc_tab_ao;
select count(*) from subt_trunc_tab_heap;
COMMIT;
